{
  "hash": "3087a56e1ae9cec7fbf6cb8e229a467d",
  "result": {
    "markdown": "---\ntitle: \"펭균 ML 보고서\"\ndescription: \"펭귄 암수예측 기계학습모형 개발 보고서\"\ndate: today # 날짜 설정: now, last-modified\nauthor:\n  - name: 이광춘\n    affiliation: TCS\ntitle-block-banner: false\nformat:\n  html:\n    theme: \n      - flatly\n      - css/quarto-fonts.css\n    code-fold: true\n    code-overflow: scroll\n    toc: true\n    toc-depth: 3\n    number-sections: true\n    highlight-style: github    \n    self-contained: false\neditor_options: \n  chunk_output_type: console\nknitr:\n  opts_chunk: \n    collapse: true\n    comment: \"#>\" \n    R.options:\n      knitr.graphics.auto_pdf: true  \nfilters:\n   - lightbox\nlightbox: auto      \n---\n\n\n\n# 들어가며\n\n파머 펭귄 성별 분류 머신러닝 모델은 인구 관리 및 모니터링을 더 효율적으로 할 수 있기 때문에 중요합니다. 개별 펭귄의 성별을 정확하게 식별함으로써 펭귄 서식지에서 성비와 산란 패턴을 더 잘 이해하고 추적 할 수 있습니다. 이러한 정보는 지구온난화로 인한 기후위기 시대 펭귄생존을 보장하는 데 필수적입니다. 또한 성별 분류 모델은 노동집약적인 성별 식별 업무를 대폭 줄여 시간과 자원을 절약을 효율적으로 사용할 수 있도록 기여합니다.\n\n# 데이터\n\n## 데이터 입수\n\n펭귄 데이터를 입수할 수 있는 방법은 크게 3가지가 있습니다.\n\n- 데이터 패키지\n- 로컬 csv 파일\n- 클라우드 저장소: Microsoft Azure Blob Storage, Google Cloud Storage, DigitalOcean Spaces, Backblaze B2, Wasabi Hot Cloud Storage, Alibaba Cloud OSS, IBM Cloud Object Storage, Oracle Cloud Infrastructure Object Storage, OpenStack Object Storage (Swift), Rackspace Cloud Files\n\n### 데이터 패키지\n\n:::{.panel-tabset}\n\n```bash\n> install.packages('palmerpenguins')\n```\n\n#### R - `palmerpenguins`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(palmerpenguins)\n\npenguins <- palmerpenguins::penguins\n\npenguins\n#> # A tibble: 344 × 8\n#>    species island    bill_length_mm bill_depth_mm flipper_…¹ body_…² sex    year\n#>    <fct>   <fct>              <dbl>         <dbl>      <int>   <int> <fct> <int>\n#>  1 Adelie  Torgersen           39.1          18.7        181    3750 male   2007\n#>  2 Adelie  Torgersen           39.5          17.4        186    3800 fema…  2007\n#>  3 Adelie  Torgersen           40.3          18          195    3250 fema…  2007\n#>  4 Adelie  Torgersen           NA            NA           NA      NA <NA>   2007\n#>  5 Adelie  Torgersen           36.7          19.3        193    3450 fema…  2007\n#>  6 Adelie  Torgersen           39.3          20.6        190    3650 male   2007\n#>  7 Adelie  Torgersen           38.9          17.8        181    3625 fema…  2007\n#>  8 Adelie  Torgersen           39.2          19.6        195    4675 male   2007\n#>  9 Adelie  Torgersen           34.1          18.1        193    3475 <NA>   2007\n#> 10 Adelie  Torgersen           42            20.2        190    4250 <NA>   2007\n#> # … with 334 more rows, and abbreviated variable names ¹​flipper_length_mm,\n#> #   ²​body_mass_g\n```\n:::\n\n\n#### Python - `palmerpenguins`\n\n```bash\n$ pip install palmerpenguins\n```\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport pandas as pd\nfrom palmerpenguins import load_penguins \n\npenguins = load_penguins()\n\npenguins.head()\n#>   species     island  bill_length_mm  ...  body_mass_g     sex  year\n#> 0  Adelie  Torgersen            39.1  ...       3750.0    male  2007\n#> 1  Adelie  Torgersen            39.5  ...       3800.0  female  2007\n#> 2  Adelie  Torgersen            40.3  ...       3250.0  female  2007\n#> 3  Adelie  Torgersen             NaN  ...          NaN     NaN  2007\n#> 4  Adelie  Torgersen            36.7  ...       3450.0  female  2007\n#> \n#> [5 rows x 8 columns]\n```\n:::\n\n\n:::\n\n\n### csv 데이터\n\n:::{.panel-tabset}\n\n#### R - `csv`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\npenguins_csv <- read_csv('data/penguins.csv')\n\npenguins_csv\n#> # A tibble: 344 × 9\n#>    rowid species island    bill_length_mm bill_dep…¹ flipp…² body_…³ sex    year\n#>    <dbl> <chr>   <chr>              <dbl>      <dbl>   <dbl>   <dbl> <chr> <dbl>\n#>  1     1 Adelie  Torgersen           39.1       18.7     181    3750 male   2007\n#>  2     2 Adelie  Torgersen           39.5       17.4     186    3800 fema…  2007\n#>  3     3 Adelie  Torgersen           40.3       18       195    3250 fema…  2007\n#>  4     4 Adelie  Torgersen           NA         NA        NA      NA <NA>   2007\n#>  5     5 Adelie  Torgersen           36.7       19.3     193    3450 fema…  2007\n#>  6     6 Adelie  Torgersen           39.3       20.6     190    3650 male   2007\n#>  7     7 Adelie  Torgersen           38.9       17.8     181    3625 fema…  2007\n#>  8     8 Adelie  Torgersen           39.2       19.6     195    4675 male   2007\n#>  9     9 Adelie  Torgersen           34.1       18.1     193    3475 <NA>   2007\n#> 10    10 Adelie  Torgersen           42         20.2     190    4250 <NA>   2007\n#> # … with 334 more rows, and abbreviated variable names ¹​bill_depth_mm,\n#> #   ²​flipper_length_mm, ³​body_mass_g\n```\n:::\n\n\n\n#### Python - `csv`\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport pandas as pd\n\npalmer_df = pd.read_csv('data/penguins.csv')\n\nprint(palmer_df.head())\n#>    rowid species     island  ...  body_mass_g     sex  year\n#> 0      1  Adelie  Torgersen  ...       3750.0    male  2007\n#> 1      2  Adelie  Torgersen  ...       3800.0  female  2007\n#> 2      3  Adelie  Torgersen  ...       3250.0  female  2007\n#> 3      4  Adelie  Torgersen  ...          NaN     NaN  2007\n#> 4      5  Adelie  Torgersen  ...       3450.0  female  2007\n#> \n#> [5 rows x 9 columns]\n```\n:::\n\n\n:::\n\n### 클라우드 저장소\n\n:::{.panel-tabset}\n\n#### Onedrive\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(pins)\nlibrary(Microsoft365R)\n\nod <- Microsoft365R::get_personal_onedrive()\nboard <- board_ms365(od, \"krvote_board\")\n# board %>% pin_write(penguins)\n\nboard %>% pin_read(\"penguins\")\n#> # A tibble: 344 × 8\n#>    species island    bill_length_mm bill_depth_mm flipper_…¹ body_…² sex    year\n#>    <fct>   <fct>              <dbl>         <dbl>      <int>   <int> <fct> <int>\n#>  1 Adelie  Torgersen           39.1          18.7        181    3750 male   2007\n#>  2 Adelie  Torgersen           39.5          17.4        186    3800 fema…  2007\n#>  3 Adelie  Torgersen           40.3          18          195    3250 fema…  2007\n#>  4 Adelie  Torgersen           NA            NA           NA      NA <NA>   2007\n#>  5 Adelie  Torgersen           36.7          19.3        193    3450 fema…  2007\n#>  6 Adelie  Torgersen           39.3          20.6        190    3650 male   2007\n#>  7 Adelie  Torgersen           38.9          17.8        181    3625 fema…  2007\n#>  8 Adelie  Torgersen           39.2          19.6        195    4675 male   2007\n#>  9 Adelie  Torgersen           34.1          18.1        193    3475 <NA>   2007\n#> 10 Adelie  Torgersen           42            20.2        190    4250 <NA>   2007\n#> # … with 334 more rows, and abbreviated variable names ¹​flipper_length_mm,\n#> #   ²​body_mass_g\n```\n:::\n\n\n#### AWS S3\n\n#### Google Cloud Storage \n\n:::\n\n# 데이터 전처리\n\n펭귄 데이터는 교육용으로 제공되지만 다른 데이터셋과 달리 결측값(`NA`)도 포함되어 있어 \n본격적인 분석을 위해서 결측값 현황을 정확히 확인하고 결측값에 대한 적절한 전략을 세우고 이를 처리해야 한다.\n\n## 결측값 현황\n\n데이터프레임에 결측값이 어떻게 분포되어 있는지 먼저 시각적으로 파악하자.\n상당수 결측값이 `sex` 칼럼에 몰려있는 것이 확인된다.\n특히, 일부 펭귄의 경우 측정 변수가 모두 결측된 현황도 파악할 수 있다.\n\n\n:::{.panel-tabset}\n\n### 전체 현황\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(naniar)\nlibrary(palmerpenguins)\n\npenguins_raw <- palmerpenguins::penguins\n\nvis_miss(penguins_raw)\n```\n\n::: {.cell-output-display}\n![](penguin_report_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n### 결측값 모아보기\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvis_miss(penguins_raw, cluster = TRUE, sort_miss = TRUE)\n```\n\n::: {.cell-output-display}\n![](penguin_report_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n:::\n\n시각적으로 확인한 후에 기술통계량을 통해 정확한 결측값 현황을 확인해보자.\n\n:::{.panel-tabset}\n\n### 전체 값 수\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnrow(penguins_raw) * ncol(penguins_raw)\n#> [1] 2752\n```\n:::\n\n\n\n### 결측값 수\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnaniar::n_miss(penguins_raw)\n#> [1] 19\n```\n:::\n\n\n### 완전한 값의 수\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnaniar::n_complete(penguins_raw)\n#> [1] 2733\n```\n:::\n\n\n### 변수별 결측값\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmiss_var_summary(penguins_raw)\n#> # A tibble: 8 × 3\n#>   variable          n_miss pct_miss\n#>   <chr>              <int>    <dbl>\n#> 1 sex                   11    3.20 \n#> 2 bill_length_mm         2    0.581\n#> 3 bill_depth_mm          2    0.581\n#> 4 flipper_length_mm      2    0.581\n#> 5 body_mass_g            2    0.581\n#> 6 species                0    0    \n#> 7 island                 0    0    \n#> 8 year                   0    0\n```\n:::\n\n\n\n### 관측점별 결측값\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmiss_case_summary(penguins_raw)\n#> # A tibble: 344 × 3\n#>     case n_miss pct_miss\n#>    <int>  <int>    <dbl>\n#>  1     4      5     62.5\n#>  2   272      5     62.5\n#>  3     9      1     12.5\n#>  4    10      1     12.5\n#>  5    11      1     12.5\n#>  6    12      1     12.5\n#>  7    48      1     12.5\n#>  8   179      1     12.5\n#>  9   219      1     12.5\n#> 10   257      1     12.5\n#> # … with 334 more rows\n```\n:::\n\n\n:::\n\n\n## 결측값 처리 전략\n\n결측값 현황을 살펴보고 결측값이 많은 4번, 272번 펭귄은 분석에서 제거하고 `sex` 암수변수는 범주형 변수라 평균과 유사한 기능을 하는 최빈값(Mode) 정보를 이용하여 결측값을 채워넣는 것으로 한다.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n\n# get_mode <- function(x) {\n#   ux <- unique(x)\n#   ux[which.max(tabulate(match(x, ux)))]\n# }\n# \n# get_mode(penguins_csv$sex)\n\npenguins_tbl <- penguins_raw %>% \n  filter( !row_number() %in% c(4, 272) ) %>% \n  mutate( sex = as.character(sex)) %>% \n  mutate( sex = if_else(is.na(sex), \"male\", sex)) %>% \n  mutate( sex = factor( sex, levels = c(\"female\", \"male\")))\n\n```\n:::\n\n\n# 탐색적 데이터 분석\n\n결측값 제거 등을 통해 데이터 전처리 작업이 완료되었다.\n다음 단계로 탐색적 데이터 분석을 통해 암수성별과 관련된 정보를 탐색적으로 파악해보자.\n\n## 기술통계량\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(explore)\n\npenguins_tbl %>% \n  describe()\n#> # A tibble: 8 × 8\n#>   variable          type     na na_pct unique    min   mean    max\n#>   <chr>             <chr> <int>  <dbl>  <int>  <dbl>  <dbl>  <dbl>\n#> 1 species           fct       0      0      3   NA     NA     NA  \n#> 2 island            fct       0      0      3   NA     NA     NA  \n#> 3 bill_length_mm    dbl       0      0    164   32.1   43.9   59.6\n#> 4 bill_depth_mm     dbl       0      0     80   13.1   17.2   21.5\n#> 5 flipper_length_mm int       0      0     55  172    201.   231  \n#> 6 body_mass_g       int       0      0     94 2700   4202.  6300  \n#> 7 sex               fct       0      0      2   NA     NA     NA  \n#> 8 year              int       0      0      3 2007   2008.  2009\n```\n:::\n\n\n\n## 단변량분석\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins_tbl %>% \n  explore_all()\n```\n\n::: {.cell-output-display}\n![](penguin_report_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n## 암수(target) 연관성\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins_tbl %>% \n  explore_all(target = sex)\n```\n\n::: {.cell-output-display}\n![](penguin_report_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n## 암수(target) 의사결정나무\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins_tbl %>% \n  explain_tree(target = sex)\n```\n\n::: {.cell-output-display}\n![](penguin_report_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n## 시각화\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins_tbl %>% \n  explore(body_mass_g, bill_length_mm, target = sex)\n```\n\n::: {.cell-output-display}\n![](penguin_report_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidymodels)\nlibrary(parttree)\n\npenguins_dt <- \n  decision_tree() %>%\n  set_engine(\"rpart\") %>%\n  set_mode(\"classification\") %>%\n  fit(sex ~ body_mass_g + bill_length_mm, data = penguins_tbl)\n\n# 시각화\npenguins_tbl %>%\n  ggplot(aes(x = body_mass_g, y = bill_length_mm)) +\n  # geom_jitter(aes(col=species), alpha=0.7) +\n  geom_point(aes(color = sex)) +\n  geom_parttree(data = penguins_dt, aes(fill=sex), alpha = 0.1,\n                flipaxes = FALSE) +\n  scale_color_manual(values = c(\"female\"  = \"blue\",\n                              \"male\" = \"red\")) +\n  scale_fill_manual(values = c(\"female\"  = \"blue\",\n                              \"male\" = \"red\")) +  \n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](penguin_report_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n\n# 암수 분류 모형\n\n## 훈련/시험 데이터셋\n\n7:3으로 훈련시험 데이터셋을 나눈다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidymodels)\n\nset.seed(123)\npenguin_split <- initial_split(penguins_tbl, strata = sex, prop = 0.7)\npenguin_train <- training(penguin_split)\npenguin_test <- testing(penguin_split)\n\nset.seed(123)\npenguin_boot <- bootstraps(penguin_train)\npenguin_boot\n#> # Bootstrap sampling \n#> # A tibble: 25 × 2\n#>    splits           id         \n#>    <list>           <chr>      \n#>  1 <split [238/87]> Bootstrap01\n#>  2 <split [238/85]> Bootstrap02\n#>  3 <split [238/87]> Bootstrap03\n#>  4 <split [238/86]> Bootstrap04\n#>  5 <split [238/79]> Bootstrap05\n#>  6 <split [238/83]> Bootstrap06\n#>  7 <split [238/88]> Bootstrap07\n#>  8 <split [238/83]> Bootstrap08\n#>  9 <split [238/91]> Bootstrap09\n#> 10 <split [238/87]> Bootstrap10\n#> # … with 15 more rows\n```\n:::\n\n\n## Feature Engineering\n\n숫자형 변수에 대해서 정규화 작업을 진행하고 범주형 변수에 대해서 One-Hot 인코딩 작업을 수행하여 Feature 로 추가시킨다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguin_rec <- recipe(sex ~ ., data = penguin_train) %>%\n  step_corr(all_numeric(), threshold = 0.9) %>% \n  step_normalize(all_numeric()) %>% \n  step_dummy(all_nominal(), -all_outcomes(), one_hot = TRUE)\n\npenguin_rec\n#> Recipe\n#> \n#> Inputs:\n#> \n#>       role #variables\n#>    outcome          1\n#>  predictor          7\n#> \n#> Operations:\n#> \n#> Correlation filter on all_numeric()\n#> Centering and scaling for all_numeric()\n#> Dummy variables from all_nominal(), -all_outcomes()\n```\n:::\n\n\n## 기본모형(RF)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrf_spec <- rand_forest() %>%\n  set_mode(\"classification\") %>% \n  set_engine(\"ranger\") \n\nrf_spec\n#> Random Forest Model Specification (classification)\n#> \n#> Computational engine: ranger\n```\n:::\n\n\n## 작업흐름\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguin_wf <- workflow() %>%\n  add_recipe(penguin_rec) %>% \n  add_model(rf_spec)\n\npenguin_wf\n#> ══ Workflow ════════════════════════════════════════════════════════════════════\n#> Preprocessor: Recipe\n#> Model: rand_forest()\n#> \n#> ── Preprocessor ────────────────────────────────────────────────────────────────\n#> 3 Recipe Steps\n#> \n#> • step_corr()\n#> • step_normalize()\n#> • step_dummy()\n#> \n#> ── Model ───────────────────────────────────────────────────────────────────────\n#> Random Forest Model Specification (classification)\n#> \n#> Computational engine: ranger\n```\n:::\n\n\n\n## 병렬처리 설정\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(doParallel)\n\ncores <- parallel::detectCores(logical = FALSE)\ncl <- makePSOCKcluster(cores)\nregisterDoParallel(cores = cl)\n\nset.seed(77)\n```\n:::\n\n\n\n## 훈련 적합\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntictoc::tic()\n\nrf_rs <- penguin_wf %>%\n  fit_resamples(\n    resamples = penguin_boot,\n    control = control_resamples(save_pred = TRUE)\n  )\n\nrf_rs\n#> # Resampling results\n#> # Bootstrap sampling \n#> # A tibble: 25 × 5\n#>    splits           id          .metrics         .notes           .predictions\n#>    <list>           <chr>       <list>           <list>           <list>      \n#>  1 <split [238/87]> Bootstrap01 <tibble [2 × 4]> <tibble [0 × 3]> <tibble>    \n#>  2 <split [238/85]> Bootstrap02 <tibble [2 × 4]> <tibble [0 × 3]> <tibble>    \n#>  3 <split [238/87]> Bootstrap03 <tibble [2 × 4]> <tibble [0 × 3]> <tibble>    \n#>  4 <split [238/86]> Bootstrap04 <tibble [2 × 4]> <tibble [0 × 3]> <tibble>    \n#>  5 <split [238/79]> Bootstrap05 <tibble [2 × 4]> <tibble [0 × 3]> <tibble>    \n#>  6 <split [238/83]> Bootstrap06 <tibble [2 × 4]> <tibble [0 × 3]> <tibble>    \n#>  7 <split [238/88]> Bootstrap07 <tibble [2 × 4]> <tibble [0 × 3]> <tibble>    \n#>  8 <split [238/83]> Bootstrap08 <tibble [2 × 4]> <tibble [0 × 3]> <tibble>    \n#>  9 <split [238/91]> Bootstrap09 <tibble [2 × 4]> <tibble [0 × 3]> <tibble>    \n#> 10 <split [238/87]> Bootstrap10 <tibble [2 × 4]> <tibble [0 × 3]> <tibble>    \n#> # … with 15 more rows\n\ntictoc::toc()\n#> 6.75 sec elapsed\n```\n:::\n\n\n## 모델 평가\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncollect_metrics(rf_rs)\n#> # A tibble: 2 × 6\n#>   .metric  .estimator  mean     n std_err .config             \n#>   <chr>    <chr>      <dbl> <int>   <dbl> <chr>               \n#> 1 accuracy binary     0.887    25 0.00746 Preprocessor1_Model1\n#> 2 roc_auc  binary     0.946    25 0.00396 Preprocessor1_Model1\n```\n:::\n\n\n### 오차 행렬\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrf_rs %>% \n  conf_mat_resampled() %>% \n  pivot_wider(names_from = Truth, values_from = Freq)\n#> # A tibble: 2 × 3\n#>   Prediction female  male\n#>   <fct>       <dbl> <dbl>\n#> 1 female      37.7   4.88\n#> 2 male         4.84 38.4\n```\n:::\n\n\n### ROC 곡선\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrf_rs %>% \n  collect_predictions() %>%\n  group_by(id) %>%\n  roc_curve(sex, .pred_female) %>%\n  ggplot(aes(1 - specificity, sensitivity, color = id)) +\n  geom_abline(lty = 2, color = \"gray80\", size = 1.5) +\n  geom_path(show.legend = FALSE, alpha = 0.6, size = 1.2) +\n  coord_equal()\n```\n\n::: {.cell-output-display}\n![](penguin_report_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n##  최종 모형\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguin_final <- penguin_wf %>%\n  last_fit(penguin_split)\n\npenguin_final\n#> # Resampling results\n#> # Manual resampling \n#> # A tibble: 1 × 6\n#>   splits            id               .metrics .notes   .predictions .workflow \n#>   <list>            <chr>            <list>   <list>   <list>       <list>    \n#> 1 <split [238/104]> train/test split <tibble> <tibble> <tibble>     <workflow>\n```\n:::\n\n\n## 모형 성능\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_perf <- collect_metrics(penguin_final)\n```\n:::\n\n\n암수 성별 예측모형의 최종 모형 정확도는 0.8557692 이고  ROC 는 0.9377778 이다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncollect_predictions(penguin_final) %>%\n  conf_mat(sex, .pred_class)\n#>           Truth\n#> Prediction female male\n#>     female     41    6\n#>     male        9   48\n```\n:::\n\n\n실제 암컷 펭귄을 수컷 펭귄으로 오분류하는 것이 그 반의 경우보다 30% 정도 더 높게 나온다.\n\n# 설명가능한 ML\n\n[`DALEX`](https://ema.drwhy.ai/) 패키지 도구를 사용하여 기계확습모형을 꼼꼼히 살펴본다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DALEX)\nlibrary(DALEXtra) \nlibrary(modelStudio) # install_dependencies()\n\npenguin_fit <- penguin_wf %>%\n  fit(data = penguin_train)\n\ny_penguin <- as.numeric(penguin_train$sex)\n\npenguin_explainer <- explain_tidymodels(penguin_fit,\n                     data = penguin_train,\n                     y = y_penguin,\n                     label = \"Penguin RF\")\n\nset.seed(123)\nnew_penguins <- penguin_train %>% slice_sample(n = 3)\n\nmodelStudio(penguin_explainer, new_observation = new_penguins)\n\n```\n:::\n\n```{=html}\n<iframe width=\"1200\" height=\"1000\" src=\"modelStudio/index.html\" title=\"Quarto Documentation\"></iframe>\n```\n\n\n\n# 주요 기여사항\n\n파머 펭귄 성별 분류 머신러닝 모델은 인구 관리 및 모니터링을 더 효율적으로 할 수 있는 예측 분류 모형을 개발하였다. 예측 모형의 정확도는 0.8557692 으로 기존 통계모형보다 우수한 정확도를 보이고 있다. \n\n\n# 한계\n\n예측 모형의 정확도가 0.8557692 으로 기존 통계모형보다 높지만 실제 업무에 배포하여 적용하는 기준 정확도 **95%**에는 미치지 못하는 한계가 있고, 개발된 암수분류 모형을 실제 운영환경에서 사용할 수 있는 추가 작업이 필요한 것으로 확인되었습니다.\n\n\n# 결론\n\n개별 펭귄의 성별을 정확하게 식별함으로써 펭귄 서식지에서 성비와 산란 패턴을 더 잘 이해하고 추적 할수 있는 성별 예측 기계학습 모형을 개발하였고 이를 실제 업무에 적용하기 위한 도전과제도 추가로 발굴되었다. 금번 프로젝트가 후속 연구개발로 이어져 기후 온난화로 인한 안정적인 펭귄 개체수 유지를 위한 발판으로 이어질 것으로 기대된다.\n\n\n",
    "supporting": [
      "penguin_report_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}